!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).QwertyHancock={})}(this,function(e){"use strict";const t=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],n=["C","D","E","F","G","A","B"],o=["C","D","F","G","A"],i={a:"Cl",s:"Dl",d:"El",f:"Fl",g:"Gl",h:"Al",j:"Bl",w:"C#l",e:"D#l",t:"F#l",y:"G#l",u:"A#l",z:"G#l",k:"Cu",l:"Du",";":"Eu","'":"Fu","\\":"Gu",o:"C#u",p:"D#u","]":"F#u"},s="keyboard",r=3,u=600,c=150,a=0,l="A3",d="#fff",h="#000",y="yellow",p="#000",f="en";function v(e){const n=parseInt(3===e.length?e.charAt(2):e.charAt(1),10),o=e.slice(0,-1),i=t.indexOf(o);let s;return s=i<3?i+12+12*(n-1)+1:i+12*(n-1)+1,440*Math.pow(2,(s-49)/12)}function g(e,t){const n=t.charAt(0),o=e.indexOf(n);if(-1===o)return[...e];const i=[],s=e.length;for(let t=0;t<s;t++){const n=(t+o)%s;i.push(e[n])}return i}function k(e,t,n){const o=t[e];if(!o)return"";const i=n.keyOctave+n.keyPressOffset,s=i+1;return o.replace("l",i.toString()).replace("u",s.toString())}function w(e){return 7*e}function m(e,t){Object.assign(e.style,t),void 0!==t.userSelect&&(e.style["-webkit-user-select"]=t.userSelect)}function b(e,t,n){return{backgroundColor:e.whiteKeyColour,border:`1px solid ${e.borderColour}`,borderRight:n?`1px solid ${e.borderColour}`:"0",height:`${e.height}px`,width:`${t}px`,borderRadius:"0 0 5px 5px",position:"relative",zIndex:"1",boxSizing:"content-box",display:"inline-block",userSelect:"none"}}function C(e,t,n){return{backgroundColor:e.blackKeyColour,border:`1px solid ${e.borderColour}`,position:"absolute",left:`${n}px`,width:`${t}px`,height:`${Math.floor(e.height/1.5)}px`,borderRadius:"0 0 3px 3px",zIndex:"2",boxSizing:"content-box",display:"inline-block",userSelect:"none"}}function E(e,t){e&&(e.style.backgroundColor=t)}function x(e,t){if(e){const n=e.getAttribute("data-note-type");e.style.backgroundColor="white"===n?t.whiteKeyColour:t.blackKeyColour}}function L(e,t){const n=document.createElement("li");return n.id=e,n.title=e,n.setAttribute("data-note-type",t),n}function D(e,t,n){const o=[],i=w(e.octaves),s=(r=e.width,u=i,Math.floor((r-u)/u));var r,u;const c=Math.floor(s/2);let a=0,l=e.startOctave;for(let r=0;r<i;r++){r%t.length===0&&(a=0);const u=t[a];"C"===u&&0!==r&&l++;const d=L(`${u}${l}`,"white"),h=r===i-1;if(m(d,b(e,s,h)),o.push(d),!h&&n.includes(u)){const t=L(`${u}#${l}`,"black");m(t,C(e,c,Math.floor((s+1)*(r+1)-c/2))),o.push(t)}a++}return o}function O(e){return e.ctrlKey||e.metaKey||e.altKey}function S(e,t,n,o){"li"===e.tagName.toLowerCase()&&(t.mouseIsDown=!0,E(e,n.activeColour),o(e.title,v(e.title)))}function $(e,t,n,o){"li"===e.tagName.toLowerCase()&&(t.mouseIsDown=!1,x(e,n),o(e.title,v(e.title)))}function K(e,t,n,o){t.mouseIsDown&&(x(e,n),o(e.title,v(e.title)))}function I(e,t,n,o,i){const s=[],r=e=>{S(e.target,i,t,o.keyDown)},u=e=>{$(e.target,i,t,o.keyUp)},c=e=>{!function(e,t,n,o){t.mouseIsDown&&(E(e,n.activeColour),o(e.title,v(e.title)))}(e.target,i,t,o.keyDown)},a=e=>{K(e.target,i,t,o.keyUp)};if(e.addEventListener("mousedown",r),e.addEventListener("mouseup",u),e.addEventListener("mouseover",c),e.addEventListener("mouseout",a),s.push(()=>{e.removeEventListener("mousedown",r),e.removeEventListener("mouseup",u),e.removeEventListener("mouseover",c),e.removeEventListener("mouseout",a)}),"ontouchstart"in document.documentElement){const n=e=>{S(e.target,i,t,o.keyDown)},r=e=>{$(e.target,i,t,o.keyUp)},u=e=>{K(e.target,i,t,o.keyUp)};e.addEventListener("touchstart",n),e.addEventListener("touchend",r),e.addEventListener("touchleave",u),e.addEventListener("touchcancel",u),s.push(()=>{e.removeEventListener("touchstart",n),e.removeEventListener("touchend",r),e.removeEventListener("touchleave",u),e.removeEventListener("touchcancel",u)})}if(t.musicalTyping){const e=e=>{!function(e,t,n,o,i){if(O(e))return;const s=e.key;if(!(s in o))return;if(t.keysDown.has(s))return;e.preventDefault(),t.keysDown.add(s);const r=k(s,o,n);E(document.getElementById(r),n.activeColour),i(r,v(r))}(e,i,t,n,o.keyDown)},r=e=>{!function(e,t,n,o,i){if(O(e))return;const s=e.key;if(!(s in o))return;t.keysDown.delete(s);const r=k(s,o,n);x(document.getElementById(r),n),i(r,v(r))}(e,i,t,n,o.keyUp)};window.addEventListener("keydown",e),window.addEventListener("keyup",r),s.push(()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",r)})}return()=>{s.forEach(e=>e())}}class A{constructor(e){this.version="1.0.0",this.keyDown=()=>{},this.keyUp=()=>{},this.cleanupListeners=null,this.keyMap={...i},this.eventState={mouseIsDown:!1,keysDown:new Set},this.settings=this.resolveSettings(e);const t=function(e){let t=document.getElementById(e.id);t||(t=document.createElement("div"),t.id=e.id,document.body.appendChild(t)),m(t,function(e){return{width:`${e.width}px`,height:`${e.height}px`,display:"block",position:"relative",boxSizing:"content-box"}}(e));const i=document.createElement("ul");m(i,function(e){return{cursor:"default",fontSize:"0px",height:`${e.height}px`,width:`${e.width}px`,padding:"0",position:"relative",listStyle:"none",margin:"number"==typeof e.margin?`${e.margin}px`:e.margin,boxSizing:"content-box",userSelect:"none"}}(e));const s=g(n,e.startNote),r=g(o,e.startNote),u=D(e,s,r);u.forEach(e=>i.appendChild(e));const c=t.querySelector("ul");return c?t.replaceChild(i,c):t.appendChild(i),{container:t,el:i,keys:u,whiteNotes:s,notesWithSharps:r,totalWhiteKeys:w(e.octaves)}}(this.settings);this.settings.keyPressOffset="C"===t.whiteNotes[0]?0:1,this.cleanupListeners=I(t.container,this.settings,this.keyMap,{keyDown:(e,t)=>this.keyDown(e,t),keyUp:(e,t)=>this.keyUp(e,t)},this.eventState)}resolveSettings(e){const t=e||{};let n=document.getElementById(t.id||s),o=t.width,i=t.height;if(n){const e=window.getComputedStyle(n);void 0===o&&(o=parseInt(e.width,10)||u),void 0===i&&(i=parseInt(e.height,10)||c)}else o=o??u,i=i??c;const v=t.startNote||l,g=parseInt(v.charAt(v.length-1),10);return{id:t.id||s,octaves:t.octaves??r,width:o,height:i,margin:t.margin??a,startNote:v,startOctave:g,keyOctave:t.keyOctave??g,whiteKeyColour:t.whiteKeyColour||d,blackKeyColour:t.blackKeyColour||h,activeColour:t.activeColour||y,borderColour:t.borderColour||p,keyboardLayout:t.keyboardLayout||f,musicalTyping:!1!==t.musicalTyping,keyPressOffset:0}}setKeyOctave(e){return this.settings.keyOctave=e,this.settings.keyOctave}getKeyOctave(){return this.settings.keyOctave}keyOctaveUp(){return this.settings.keyOctave++,this.settings.keyOctave}keyOctaveDown(){return this.settings.keyOctave--,this.settings.keyOctave}getKeyMap(){return this.keyMap}setKeyMap(e){return this.keyMap=e,this.keyMap}destroy(){this.cleanupListeners&&(this.cleanupListeners(),this.cleanupListeners=null)}}e.QwertyHancock=A,e.default=A,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.min.js.map
